
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excelå­¦ç”Ÿæ•°æ®è½¬ä»£ç å·¥å…·</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-green-50 to-blue-50 min-h-screen p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl font-bold text-center text-blue-700 mb-8">ğŸ“Š Excelå­¦ç”Ÿæ•°æ®è½¬ä»£ç å·¥å…·</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- å·¦ä¾§ï¼šè¾“å…¥åŒºåŸŸ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">ğŸ“¥ æ•°æ®è¾“å…¥</h2>
                
                <!-- ä½¿ç”¨è¯´æ˜ -->
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                    <h3 class="font-semibold text-blue-800 mb-2">ğŸ”§ ä½¿ç”¨æ­¥éª¤ï¼š</h3>
                    <ol class="text-sm text-blue-700 space-y-1 list-decimal list-inside">
                        <li>åœ¨Excelä¸­é€‰æ‹©å­¦å·å’Œå§“åä¸¤åˆ—æ•°æ®</li>
                        <li>å¤åˆ¶é€‰ä¸­çš„æ•°æ® (Ctrl+C)</li>
                        <li>ç²˜è´´åˆ°ä¸‹é¢çš„æ–‡æœ¬æ¡† (Ctrl+V)</li>
                        <li>å¡«å†™ç­çº§ä¿¡æ¯</li>
                        <li>ç‚¹å‡»"ç”Ÿæˆä»£ç "</li>
                        <li>å¤åˆ¶å³ä¾§ç”Ÿæˆçš„å®Œæ•´ä»£ç </li>
                    </ol>
                </div>
                
                <!-- ç­çº§ä¿¡æ¯ -->
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ç­çº§ID</label>
                        <input id="classId" type="text" placeholder="ä¾‹å¦‚ï¼šai2024" 
                               class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500">
                        <p class="text-xs text-gray-500 mt-1">è‹±æ–‡æ ‡è¯†ç¬¦ï¼Œç¨‹åºå†…éƒ¨ä½¿ç”¨</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ç­çº§åç§°</label>
                        <input id="className" type="text" placeholder="ä¾‹å¦‚ï¼šäººå·¥æ™ºèƒ½2024çº§" 
                               class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500">
                        <p class="text-xs text-gray-500 mt-1">ä¸­æ–‡æ˜¾ç¤ºåç§°</p>
                    </div>
                </div>
                
                <!-- Excelæ•°æ®è¾“å…¥ -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Excelæ•°æ®ç²˜è´´åŒº</label>
                    <textarea id="excelData" rows="12" 
                              placeholder="ä»Excelå¤åˆ¶å­¦å·å’Œå§“åä¸¤åˆ—ï¼Œç„¶åç²˜è´´åˆ°è¿™é‡Œ...&#10;&#10;ç¤ºä¾‹æ ¼å¼ï¼š&#10;20240001    å¼ ä¸‰&#10;20240002    æå››&#10;20240003    ç‹äº”&#10;20240004    èµµå…­"
                              class="w-full p-3 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 font-mono text-sm resize-none"></textarea>
                </div>
                
                <!-- çŠ¶æ€æ˜¾ç¤º -->
                <div class="flex justify-between items-center mb-4">
                    <span class="text-sm text-gray-600">
                        æ£€æµ‹åˆ°å­¦ç”Ÿï¼š<span id="studentCount" class="font-bold text-green-600">0</span> äºº
                    </span>
                    <span id="status" class="text-sm text-gray-500"></span>
                </div>
                
                <!-- ç”ŸæˆæŒ‰é’® -->
                <button onclick="generateCode()" 
                        class="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition duration-200">
                    ğŸš€ ç”Ÿæˆä»£ç 
                </button>
                
                <!-- å¿«é€Ÿæµ‹è¯•æ•°æ®æŒ‰é’® -->
                <button onclick="loadTestData()" 
                        class="w-full mt-2 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 text-sm">
                    ğŸ“ åŠ è½½æµ‹è¯•æ•°æ®
                </button>
            </div>
            
            <!-- å³ä¾§ï¼šä»£ç è¾“å‡ºåŒºåŸŸ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">ğŸ“¤ ç”Ÿæˆçš„ä»£ç </h2>
                
                <!-- ä»£ç é¢„è§ˆ -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">å®Œæ•´ç­çº§ä»£ç </label>
                    <textarea id="generatedCode" rows="18" readonly
                              class="w-full p-3 border border-gray-300 rounded bg-gray-50 font-mono text-sm resize-none"
                              placeholder="ç”Ÿæˆçš„ä»£ç å°†åœ¨è¿™é‡Œæ˜¾ç¤º...&#10;&#10;ä½ å¯ä»¥ç›´æ¥å¤åˆ¶è¿™æ®µä»£ç ï¼Œ&#10;ç²˜è´´åˆ°ç¨‹åºçš„ studentClasses æ•°ç»„ä¸­ã€‚"></textarea>
                </div>
                
                <!-- æ“ä½œæŒ‰é’® -->
                <div class="flex gap-2 mb-4">
                    <button onclick="copyCode()" 
                            class="flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold">
                        ğŸ“‹ å¤åˆ¶ä»£ç 
                    </button>
                    <button onclick="clearAll()" 
                            class="flex-1 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                        ğŸ—‘ï¸ æ¸…ç©ºé‡ç½®
                    </button>
                </div>
                
                <!-- ä½¿ç”¨æç¤º -->
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <h3 class="font-semibold text-yellow-800 mb-2">ğŸ’¡ å¦‚ä½•ä½¿ç”¨ç”Ÿæˆçš„ä»£ç ï¼š</h3>
                    <div class="text-sm text-yellow-700 space-y-1">
                        <p>1. å¤åˆ¶ä¸Šé¢ç”Ÿæˆçš„å®Œæ•´ä»£ç </p>
                        <p>2. åœ¨ç¨‹åºæºç ä¸­æ‰¾åˆ°ï¼š<code class="bg-yellow-200 px-1 rounded">const studentClasses = [</code></p>
                        <p>3. å°†ä»£ç ç²˜è´´åˆ°æ•°ç»„ä¸­ï¼Œæ³¨æ„åœ¨å‰ä¸€ä¸ªç­çº§ååŠ é€—å·</p>
                        <p>4. ä¿å­˜æ–‡ä»¶å¹¶åˆ·æ–°é¡µé¢</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åº•éƒ¨ç¤ºä¾‹ -->
        <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ Excelå¤åˆ¶ç¤ºä¾‹</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-medium text-gray-700 mb-2">Excelä¸­çš„æ•°æ®æ ¼å¼ï¼š</h4>
                    <div class="bg-gray-100 p-3 rounded font-mono text-sm">
                        <table class="w-full">
                            <tr><td class="border border-gray-300 p-1">20240001</td><td class="border border-gray-300 p-1">å¼ ä¸‰</td></tr>
                            <tr><td class="border border-gray-300 p-1">20240002</td><td class="border border-gray-300 p-1">æå››</td></tr>
                            <tr><td class="border border-gray-300 p-1">20240003</td><td class="border border-gray-300 p-1">ç‹äº”</td></tr>
                            <tr><td class="border border-gray-300 p-1">20240004</td><td class="border border-gray-300 p-1">èµµå…­</td></tr>
                        </table>
                    </div>
                </div>
                <div>
                    <h4 class="font-medium text-gray-700 mb-2">å¤åˆ¶åç²˜è´´çš„æ ¼å¼ï¼š</h4>
                    <div class="bg-gray-100 p-3 rounded font-mono text-sm">
                        20240001&nbsp;&nbsp;&nbsp;&nbsp;å¼ ä¸‰<br>
                        20240002&nbsp;&nbsp;&nbsp;&nbsp;æå››<br>
                        20240003&nbsp;&nbsp;&nbsp;&nbsp;ç‹äº”<br>
                        20240004&nbsp;&nbsp;&nbsp;&nbsp;èµµå…­
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å®æ—¶æ£€æµ‹è¾“å…¥æ•°æ®å˜åŒ–
        document.getElementById('excelData').addEventListener('input', function() {
            updateStudentCount();
        });

        function updateStudentCount() {
            const data = document.getElementById('excelData').value.trim();
            const students = parseExcelData(data);
            document.getElementById('studentCount').textContent = students.length;
            
            if (students.length > 0) {
                document.getElementById('status').textContent = 'âœ… æ•°æ®æ ¼å¼æ­£ç¡®';
                document.getElementById('status').className = 'text-sm text-green-600';
            } else if (data) {
                document.getElementById('status').textContent = 'âš ï¸ è¯·æ£€æŸ¥æ•°æ®æ ¼å¼';
                document.getElementById('status').className = 'text-sm text-orange-600';
            } else {
                document.getElementById('status').textContent = '';
            }
        }

        function parseExcelData(data) {
            if (!data.trim()) return [];
            
            const lines = data.trim().split('\n');
            const students = [];
            
            for (let line of lines) {
                line = line.trim();
                if (!line) continue;
                
                // æ”¯æŒåˆ¶è¡¨ç¬¦ã€å¤šä¸ªç©ºæ ¼ã€é€—å·ç­‰åˆ†éš”ç¬¦
                const parts = line.split(/[\t\s,]+/).filter(part => part.trim());
                
                if (parts.length >= 2) {
                    const id = parts[0].trim();
                    const name = parts[1].trim();
                    
                    if (id && name) {
                        students.push({id, name});
                    }
                }
            }
            
            return students;
        }

        function generateCode() {
            const classId = document.getElementById('classId').value.trim();
            const className = document.getElementById('className').value.trim();
            const data = document.getElementById('excelData').value.trim();
            
            if (!classId) {
                alert('âŒ è¯·å¡«å†™ç­çº§ID');
                return;
            }
            
            if (!className) {
                alert('âŒ è¯·å¡«å†™ç­çº§åç§°');
                return;
            }
            
            if (!data) {
                alert('âŒ è¯·ç²˜è´´Excelæ•°æ®');
                return;
            }
            
            const students = parseExcelData(data);
            
            if (students.length === 0) {
                alert('âŒ æœªè¯†åˆ«åˆ°æœ‰æ•ˆçš„å­¦ç”Ÿæ•°æ®ï¼Œè¯·æ£€æŸ¥æ ¼å¼');
                return;
            }
            
            // ç”Ÿæˆå®Œæ•´çš„ç­çº§ä»£ç 
            let code = `    {\n        id: '${classId}',\n        name: '${className}',\n        students: [\n`;
            
            // æ¯è¡Œæ˜¾ç¤º3ä¸ªå­¦ç”Ÿï¼Œæ ¼å¼æ›´ç´§å‡‘ç¾è§‚
            for (let i = 0; i < students.length; i += 3) {
                code += '            ';
                const chunk = students.slice(i, i + 3);
                const studentStrings = chunk.map(s => `{id: '${s.id}', name: '${s.name}'}`);
                code += studentStrings.join(', ');
                if (i + 3 < students.length) {
                    code += ',';
                }
                code += '\n';
            }
            
            code += `        ]\n    }`;
            
            document.getElementById('generatedCode').value = code;
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            document.getElementById('status').textContent = `âœ… å·²ç”Ÿæˆ ${students.length} åå­¦ç”Ÿçš„ä»£ç `;
            document.getElementById('status').className = 'text-sm text-green-600';
        }

        function copyCode() {
            const codeTextarea = document.getElementById('generatedCode');
            if (!codeTextarea.value.trim()) {
                alert('âŒ è¯·å…ˆç”Ÿæˆä»£ç ');
                return;
            }
            
            codeTextarea.select();
            document.execCommand('copy');
            
            // æä¾›è§†è§‰åé¦ˆ
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
            btn.className = 'flex-1 py-2 bg-green-800 text-white rounded-lg font-semibold';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.className = 'flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold';
            }, 2000);
        }

        function clearAll() {
            document.getElementById('classId').value = '';
            document.getElementById('className').value = '';
            document.getElementById('excelData').value = '';
            document.getElementById('generatedCode').value = '';
            document.getElementById('studentCount').textContent = '0';
            document.getElementById('status').textContent = '';
        }

        function loadTestData() {
            document.getElementById('classId').value = 'test2024';
            document.getElementById('className').value = 'æµ‹è¯•ç­çº§2024çº§';
            document.getElementById('excelData').value = `20240001	å¼ ä¸‰
20240002	æå››
20240003	ç‹äº”
20240004	èµµå…­
20240005	é’±ä¸ƒ
20240006	å­™å…«
20240007	å‘¨ä¹
20240008	å´å`;
            updateStudentCount();
        }
    </script>
</body>
</html>
